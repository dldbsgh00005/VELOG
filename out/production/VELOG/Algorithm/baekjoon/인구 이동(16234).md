```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.*;

public class 인구이동_16234 {

    /**
     * N*N 크기의 땅
     * 땅은 1*1 크기
     * 각 땅에 1개의 나라 존재
     * r행 c열에는 A[r][c] 명이 거주중 >> 초기값
     * 인접 국가간 국경선 존재
     * 정사각형 모향의 국경선\
     *
     * 인접 국가간 인구 차이가 L < X < R -> 국경선 개방
     * 국경선 개방 시 인구이동 시작 -
     * 연합 = 개방된 국경선만을 이용해 이동 가능한 연결된 국가들
     * 인구 이동 = (연합 국가 인구수 합) / (연합 국가 수)
     *
     * = 테트리스 블록처럼 연합 블록이 생김
     * 인구 이동을 반복해 더이상 인구수 차이가 L 이상 R 이하가 아니게 되면 종료
     *
     * **/

    /**
     * 1. Country 클래스 ( int r, int c, int nationNumber )
     * 2. boolean[N-1][N-1] : 이미 연합이 된 국가
     * 3. 범위 조심 0 < r,c < N-1
     * 3. ArrayList<ArrayList<Country>> unions = new ArrayList<Country>();
     * 4. 1 day -> for-each 요소 순회 -> union의 각 국가 인구수 합 / 국가 수 (내림) -> 각 국가의 좌표에 인구수 갱신
     *
     * **/
    static final int[] dr = {0, 1, 0, -1};
    static final int[] dc = {1, 0, -1, 0};
    static ArrayList<ArrayList<Country>> unions;
    static boolean[][] unified;
    static int[][] countries;
    static int N;
    static int L;
    static int R;
    static boolean isFinal;
    static int day = 0;
    static class Country{
        int r;
        int c;
        int nationNumber;

        public Country(int r, int c, int nationNumber) {
            this.r = r;
            this.c = c;
            this.nationNumber = nationNumber;
        }
    }

    public static void main(String[] args) throws IOException {

        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine());

        N = Integer.parseInt(st.nextToken());
        L = Integer.parseInt(st.nextToken());
        R = Integer.parseInt(st.nextToken());

        unified = new boolean[N][N];
        countries = new int[N][N];

        for(int i = 0; i < N; i++){
            st = new StringTokenizer(br.readLine());
            for(int j = 0; j < N; j++){
                int nationNum = Integer.parseInt(st.nextToken());
                countries[i][j] = nationNum;
            }
        }
        unions = new ArrayList<>();
        isFinal = false;

        while(!isFinal){
            isFinal = true; // unify 에서 union이 추가 될 때 false로 갱신 / 추가되지 않으면 true값 유지되어 while문 종료
            initializeUnified(); // 방문 초기화
            unify();
            if(isFinal) break;
            updateNationNumber();
            unions.clear();
            day++;
        }

        System.out.println(day);

    }

    public static void unify(){
        for(int r = 0; r < countries.length; r++){
            for(int c = 0; c < countries.length; c++){
                if(!unified[r][c]){
                    buildUnionByBfs(r, c);
                    // 연합 미소속 -> bfs
                    // 방문 여부 확인, 사방 범위 체크 및 인구수 차이 확인 후 해당되면 union, 자신이 포함되어 있지 않다면 자신도 union 포함
                    // 반복 수행
                }
            }
        }

    }

    public static void buildUnionByBfs(int r, int c){
        ArrayList<Country> union = new ArrayList<>();

        union.add(new Country(r,c, countries[r][c]));
        unified[r][c] = true;

        Queue<int[]> queue = new ArrayDeque<>();
        queue.offer(new int[]{r,c});

        while(!queue.isEmpty()){

            int[] point = queue.poll();
            int cr = point[0];
            int cc = point[1];

            for(int d = 0; d < 4; d++){

                int nr = cr + dr[d];
                int nc = cc + dc[d];

                if(nr < 0 || nr > N-1 || nc < 0 || nc > N-1) continue;
                if(unified[nr][nc]) continue;

                int nationNumberDiff = Math.abs(countries[cr][cc] - countries[nr][nc]);
                if(nationNumberDiff < L || nationNumberDiff > R) continue;

                union.add(new Country(nr, nc, countries[nr][nc]));
                queue.add(new int[]{nr, nc});
                unified[nr][nc] = true;
            }
        }
        if(union.size() > 1){
            unions.add(union);
            isFinal = false;
        }

    }

    // unios를 countries에 반영
    public static void updateNationNumber(){
        // for-each 기반 unions 순회 -> union 추출 -> union의 연합 국가 인구 총합 / 연합 국가 수 -> 각 국가에 r,c 기반 인구 갱신
        for(ArrayList<Country> union : unions){

            int nationNumberSum = 0;
            int countryNumber = union.size();

            for(Country country : union){
                nationNumberSum += country.nationNumber;
            }

            int newNationNumber = nationNumberSum / countryNumber;

            for(Country country : union){

                int r = country.r;
                int c = country.c;

                countries[r][c] = newNationNumber;
            }
        }
    }

    // unified 배열 초기화
    public static void initializeUnified(){
        for(boolean[] unify : unified){
            Arrays.fill(unify, false);
        }
    }

}


```
